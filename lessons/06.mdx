import { themes, Head, Footer, Header, Steps, Notes, Invert } from 'mdx-deck'
import './styles.css'

export const theme = { ...themes.highlight }

<!-- general markup for all slides -->

<Head>
  <title>SofaScore Academy 6</title>
</Head>
<Header>
  <div className="tC m8">SofaScore Academy 2020.</div>
</Header>
<Footer>
  <div className="tR m8">Lesson 6 - React.js - Advanced Concepts</div>
</Footer>

<!-- Slides -->

# Lesson 5

## React.js - Advanced Concepts

---

# React Concepts (Patterns)

- React patterns for fixing common problems:
  - Wrapping elements
  - Prop drilling
  - Logic resuablity

<Notes>

- React has some features that are used to solve common problems when building web apps. Those problems are:
  - Every component must have exactly one top level element (most common is `div`). In some cases that wrapping can brake styles.
  - Prop drilling -> Anti-pattern where props are passed through component tree (e.g. parent sends handler deeper down tree, more then few levels).
  - Logic is bound to components with presentation and as such is hardly reusable.

</Notes>

---

# React Fragment

- Can be used to wrap elements in the single element
- Won't add top level element (Fragment) to the DOM
- Long (`<React.Fragment>`) and short (`<>`) syntax
  - Short syntax can't have props (even `key`)

<Notes>

- Commonly used in React codebases.
- Fragment has no DOM representation and will be omitted from the DOM -> won't effect styles and hierarchies.
- Short syntax is more used, but it can't take props (event `key`) so it should be avoided as top element for list items,
  where `key` is necessary (use long syntax there).

</Notes>

---

# React Fragment Usage

### Long syntax

```react
<React.Fragment>
  <h1>HELLO</h1>
</React.Fragment>
```

### Short syntax

```react
<>
  <h1>HELLO</h1>
</>
```

---

import { Table } from './06-files/Fragment'

<Invert>

# React Fragment - Example

<Table />

</Invert>

---

# React Refs

- React is declerative and abstracts DOM manipulations
- Gets reference on underlying DOM element
  - Access DOM element properties (e.g. height, position, ...)
- Returns object with `current` key set to DOM object or `null`
- `useRef` hook - `const ref = userRef(null)`
- `createRef` method - `this.ref = createRef(null)`

<Notes>

- React is declerative, it abstracts DOM elements and manipulations. Sometime developers need access to underlying DOM elements.
- React Refs allows access to underlying DOM elements. Access to those elements allows developers to get element height, position, to add DOM attributes, ...
- Refs can be used in class components and functional components via `useRef` hook.
- Ref will be returned in object as `current` property. `current` property is reference to DOM element or null if element is not set.
- Refs can be used inside class components (`createRef`) or inside functional components (useRef`) hook.
- Refs are commonly used with generic base components (input, button).

</Notes>

---

import { Refs } from './06-files/Refs'

<Invert>

# React Refs - Example

<Refs />

</Invert>

---

# Refs Forwarding

- Ref added on React component will return that React component or `undefined`
- `ref` is not available via props (same as `key`)
- Tehnique of returning underlying DOM elements form components to parent component via `ref`
- `React.forwardRef((props, ref) => JSX Markup)`

<Notes>

- Common use case is adding Ref to existing React component (e.g. `<Form ref={formRef} />`). This ref wouldn't work out of the box, at least not as expected.
  It would return React component instead of DOM element if used on class component, or `undefined` if used on functional component.
  That behaviour can be "fixed" with Forwating refs.
- `ref` cannot be accessed via props, as it is internal to React and will be stripped (i.e. same as `key` prop).
- Forwarding refs allow developers to add refs on React components and receive DOM element instead of React components.
- Components taht should return DOM elmenents as ref should be wrapped in React.forwardRef and set provided ref to desired DOM element.

</Notes>

---

import { Form } from './06-files/ForwardingRefs'

<Invert>

# React Forwarding Refs - Example

<Form />

</Invert>

---

# React Context

- avoid prop drilling
- used to make values accessible deeper from hierarchy
- children can chage value and rerender provider
- `useContext` hook

---

<Invert>

# React Context - Example

- provide theme to components, change theme deeper from tree

</Invert>

---

# React Portal

- add components outside hierarchy
  - modals, dialogs, absolute elements
- Singelton

---

<Invert>

# React Portal - Example

- modal example

</Invert>

---

# High Order Component / Render Props / Custom Hooks

- reuse logic, atomic components (SRP)
- insert logic into existing components
- HOC -> via props (can colide with existing props)
- RP -> avoids colliding, more expressive
- Custom hooks

---

<Invert>

# High Order Component / Render Props / Custom hook - Example

- Toggle reuse (On / off) -> switch, accordion

</Invert>

---

# Reducers

- definition
- graph -> state - action - reducer - state
- redux

---

# `useReducer`

- complex state manipulations
  - when single change makes multiple state changes (set data, reset loader, reset error)
- `useState` must set whole state
- `useReducer` can set partial state

---

<Invert>

# `useReducer` - Example

- fetch example with loader and error

</Invert>

---

# REDUX
